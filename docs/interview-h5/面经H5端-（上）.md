# é¢ç» H5 ç«¯ - Vantï¼ˆä¸Šï¼‰

[æ¥å£æ–‡æ¡£åœ°å€](https://www.apifox.cn/apidoc/project-934563/api-20384515)

## é¡¹ç›®åˆ›å»ºç›®å½•åˆå§‹åŒ–

### vue-cli å»ºé¡¹ç›®

åˆ›å»ºé¡¹ç›®

```
vue create hm-vant-h5
```

- é€‰é¡¹

```js
Vue CLI v5.0.4
? Please pick a preset: (Use arrow keys)
  Default ([Vue 3] babel, eslint)
  Default ([Vue 2] babel, eslint)
> Manually select features      é€‰è‡ªå®šä¹‰
```

- æ‰‹åŠ¨é€‰æ‹©åŠŸèƒ½-**å›è½¦ç¡®å®š**

![image-20221224152939988](./images/image-20221224152939988.png)

- é€‰æ‹© vue çš„ç‰ˆæœ¬

```jsx
  3.x
> 2.x
```

- æ˜¯å¦ä½¿ç”¨ history æ¨¡å¼

![image-20201025150602129](./images/image-20201025150602129.png)

- é€‰æ‹© css é¢„å¤„ç†

![image-20220629175133593](./images/image-20220629175133593.png)

- é€‰æ‹©é…ç½®æ–‡ä»¶çš„ç”Ÿæˆæ–¹å¼ ï¼ˆç›´æ¥å›è½¦ï¼‰

![image-20201025151123023](./images/image-20201025151123023.png)

- æ˜¯å¦ä¿å­˜é¢„è®¾ï¼Œä¸‹æ¬¡ç›´æ¥ä½¿ç”¨ï¼Ÿ => ä¸ä¿å­˜ï¼Œè¾“å…¥ N

![image-20220613025710360](./images/image-20220613025710360.png)

- ç­‰å¾…å®‰è£…ï¼Œé¡¹ç›®åˆå§‹åŒ–å®Œæˆ

![image-20220613025814865](./images/image-20220613025814865.png)

- å¯åŠ¨é¡¹ç›®

```
npm run serve
```

### è°ƒæ•´åˆå§‹åŒ–ç›®å½•ç»“æ„

> å¼ºçƒˆå»ºè®®å¤§å®¶ä¸¥æ ¼æŒ‰ç…§è€å¸ˆçš„æ­¥éª¤è¿›è¡Œè°ƒæ•´ï¼Œä¸ºäº†ç¬¦åˆä¼ä¸šè§„èŒƒ

ä¸ºäº†æ›´å¥½çš„å®ç°åé¢çš„æ“ä½œï¼Œæˆ‘ä»¬æŠŠæ•´ä½“çš„ç›®å½•ç»“æ„åšä¸€äº›è°ƒæ•´ã€‚

ç›®æ ‡:

1. åˆ é™¤åˆå§‹åŒ–çš„ä¸€äº›é»˜è®¤æ–‡ä»¶
2. ä¿®æ”¹æ²¡åˆ é™¤çš„æ–‡ä»¶
3. æ–°å¢æˆ‘ä»¬éœ€è¦çš„ç›®å½•ç»“æ„

#### ä¿®æ”¹æ–‡ä»¶

1. `main.js` ä¸éœ€è¦ä¿®æ”¹

2. `router/index.js`

åˆ é™¤é»˜è®¤çš„è·¯ç”±é…ç½®

```js
import Vue from "vue";
import VueRouter from "vue-router";

Vue.use(VueRouter);

const routes = [];

const router = new VueRouter({
  routes,
});

export default router;
```

3. `App.vue`

```html
<template>
  <div id="app">
    <router-view />
  </div>
</template>
```

#### åˆ é™¤æ–‡ä»¶

- src/views/AboutView.vue

- src/views/HomeView.vue

- src/components/HelloWorld.vue

- src/assets/logo.png

#### æ–°å¢ç›®å½•

- src/api ç›®å½•
  - å­˜å‚¨æ¥å£æ¨¡å— (å‘é€ ajax è¯·æ±‚æ¥å£çš„æ¨¡å—)
- src/utils ç›®å½•
  - å­˜å‚¨ä¸€äº›å·¥å…·æ¨¡å— (è‡ªå·±å°è£…çš„æ–¹æ³•)

* src/assets ç›®å½•
  - é¡¹ç›®ä½¿ç”¨çš„ç´ æ

ç›®å½•æ•ˆæœå¦‚ä¸‹:

![image-20220613033022857](./images/image-20220613033022857.png)

## vant æŒ‰éœ€åŠ è½½

### vant-ui ç»„ä»¶åº“çš„å¼•å…¥

> ç»„ä»¶åº“ï¼šç¬¬ä¸‰æ–¹å°è£…å¥½äº†å¾ˆå¤šå¾ˆå¤šçš„ç»„ä»¶ï¼Œæ•´åˆåˆ°ä¸€èµ·å°±æ˜¯ä¸€ä¸ªç»„ä»¶åº“ã€‚
>
> https://vant-contrib.gitee.io/vant/v2/#/zh-CN/

ç»„ä»¶åº“å¹¶ä¸æ˜¯å”¯ä¸€çš„

pc: element-ui iview **ant-design**

ç§»åŠ¨ï¼švant-ui

### æŒ‰éœ€åŠ è½½

- å®‰è£… vant-ui

```
npm i vant@latest-v2
```

- å®‰è£…ä¸€ä¸ªæ’ä»¶

```bash
npm i babel-plugin-import -D
```

- åœ¨`babel.config.js`ä¸­é…ç½®

```js
module.exports = {
  presets: ["@vue/cli-plugin-babel/preset"],
  plugins: [
    [
      "import",
      {
        libraryName: "vant",
        libraryDirectory: "es",
        style: true,
      },
      "vant",
    ],
  ],
};
```

- é‡å¯æ‰“åŒ…
- æŒ‰éœ€åŠ è½½ï¼Œåœ¨`main.js`

```js
import { Button, Icon } from "vant";

Vue.use(Button);
Vue.use(Icon);
```

- `App.vue`ä¸­è¿›è¡Œæµ‹è¯•

```vue
<van-button type="primary">ä¸»è¦æŒ‰é’®</van-button>
<van-button type="info">ä¿¡æ¯æŒ‰é’®</van-button>
<van-button type="default">é»˜è®¤æŒ‰é’®</van-button>
<van-button type="warning">è­¦å‘ŠæŒ‰é’®</van-button>
<van-button type="danger">å±é™©æŒ‰é’®</van-button>
```

## é¡¹ç›®ä¸­çš„ vw é€‚é…

å®˜æ–¹è¯´æ˜ï¼šhttps://vant-contrib.gitee.io/vant/v2/#/zh-CN/advanced-usage

```js
npm i postcss-px-to-viewport@1.1.1 -D
```

- é¡¹ç›®æ ¹ç›®å½•ï¼Œ æ–°å»º postcss çš„é…ç½®æ–‡ä»¶`postcss.config.js`

```js
// postcss.config.js
module.exports = {
  plugins: {
    "postcss-px-to-viewport": {
      viewportWidth: 375,
    },
  },
};
```

## è·¯ç”±è®¾è®¡é…ç½®

ä½†å‡¡æ˜¯å•ä¸ªé¡µé¢ï¼Œç‹¬ç«‹å±•ç¤ºçš„ï¼Œéƒ½æ˜¯ä¸€çº§è·¯ç”±

è·¯ç”±è®¾è®¡ï¼š

- ç™»å½•é¡µ ï¼ˆä¸€çº§ï¼‰ login
- æ³¨å†Œé¡µï¼ˆä¸€çº§ï¼‰ register
- æ–‡ç« è¯¦æƒ…é¡µï¼ˆä¸€çº§ï¼‰ detail
- é¦–é¡µï¼ˆä¸€çº§ï¼‰ layout
  - é¢ç»ï¼ˆäºŒçº§ï¼‰article
  - æ”¶è—ï¼ˆäºŒçº§ï¼‰collect
  - å–œæ¬¢ï¼ˆäºŒçº§ï¼‰like
  - æˆ‘çš„ï¼ˆäºŒçº§ï¼‰my

### ä¸€çº§è·¯ç”±

`router/index.js`é…ç½®ä¸€çº§è·¯ç”±, ä¸€çº§ views ç»„ä»¶äºæ•™å­¦èµ„æ–™ä¸­ç›´æ¥ CV å³å¯

```js
import Vue from "vue";
import VueRouter from "vue-router";
import Login from "@/views/Login";
import Register from "@/views/Register";
import Detail from "@/views/Detail";
import Layout from "@/views/Layout";
Vue.use(VueRouter);

const router = new VueRouter({
  routes: [
    { path: "/", component: Layout },
    { path: "/login", component: Login },
    { path: "/register", component: Register },
    { path: "/detail/:id", component: Detail },
  ],
});

export default router;
```

æ¸…ç† `App.vue`

```vue
<template>
  <div id="app">
    <router-view />
  </div>
</template>

<script>
export default {
  async created() {},
};
</script>
```

### tabbar æ ‡ç­¾é¡µ

![image-20220614061531984](./images/image-20220614061531984.png)

https://vant-contrib.gitee.io/vant/v2/#/zh-CN/tabbar

`main.js` å¼•å…¥ç»„ä»¶

```js
import { Button, Icon, Tabbar, TabbarItem } from "vant";
Vue.use(Tabbar);
Vue.use(TabbarItem);
```

`layout.vue`

```vue
<template>
  <div class="layout-page">
    é¦–é¡µæ¶å­ - å†…å®¹åŒºåŸŸ
    <van-tabbar>
      <van-tabbar-item icon="notes-o">é¢ç»</van-tabbar-item>
      <van-tabbar-item icon="star-o">æ”¶è—</van-tabbar-item>
      <van-tabbar-item icon="like-o">å–œæ¬¢</van-tabbar-item>
      <van-tabbar-item icon="user-o">æˆ‘çš„</van-tabbar-item>
    </van-tabbar>
  </div>
</template>
```

### äºŒçº§è·¯ç”±

`router/index.js`é…ç½®äºŒçº§è·¯ç”±

```js
import Vue from "vue";
import VueRouter from "vue-router";
import Login from "@/views/login";
import Register from "@/views/register";
import Detail from "@/views/detail";
import Layout from "@/views/layout";

import Like from "@/views/like";
import Article from "@/views/article";
import Collect from "@/views/collect";
import User from "@/views/user";
Vue.use(VueRouter);

const router = new VueRouter({
  routes: [
    { path: "/login", component: Login },
    { path: "/register", component: Register },
    { path: "/article/:id", component: Detail },
    {
      path: "/",
      component: Layout,
      redirect: "/article",
      children: [
        { path: "article", component: Article },
        { path: "like", component: Like },
        { path: "collect", component: Collect },
        { path: "user", component: User },
      ],
    },
  ],
});

export default router;
```

`layout.vue` é…ç½®è·¯ç”±å‡ºå£, é…ç½® tabbar

```jsx
<template>
  <div class="layout-page">
    <router-view></router-view>

    <van-tabbar route>
      <van-tabbar-item to="/article" icon="notes-o">
        é¢ç»
      </van-tabbar-item>
      <van-tabbar-item to="/collect" icon="star-o">
        æ”¶è—
      </van-tabbar-item>
      <van-tabbar-item to="/like" icon="like-o">
        å–œæ¬¢
      </van-tabbar-item>
      <van-tabbar-item to="/user" icon="user-o">
        æˆ‘çš„
      </van-tabbar-item>
    </van-tabbar>
  </div>
</template>
```

æ•ˆæœå›¾ï¼š

![image-20220701151639583](./images/image-20220701151639583.png)

## ç™»å½•&æ³¨å†ŒåŠŸèƒ½

### ç™»å½•é™æ€å¸ƒå±€

![image-20220614062935057](./images/image-20220614062935057.png)

ä½¿ç”¨ç»„ä»¶

- van-nav-bar
- van-form
- van-field
- van-button

`vant-ui.js` æ³¨å†Œ

```jsx
import Vue from "vue";
import { NavBar, Form, Field } from "vant";
Vue.use(NavBar);
Vue.use(Form);
Vue.use(Field);
```

`login.vue` ä½¿ç”¨

```jsx
<template>
  <div class="login-page">
    <!-- å¯¼èˆªæ éƒ¨åˆ† -->
    <van-nav-bar title="é¢ç»ç™»å½•" />

    <!-- ä¸€æ—¦formè¡¨å•æäº¤äº†ï¼Œå°±ä¼šè§¦å‘submitï¼Œå¯ä»¥åœ¨submitäº‹ä»¶ä¸­
         æ ¹æ®æ‹¿åˆ°çš„è¡¨å•æäº¤ä¿¡æ¯ï¼Œå‘é€axiosè¯·æ±‚
     -->
    <van-form @submit="onSubmit">
      <!-- è¾“å…¥æ¡†ç»„ä»¶ -->
      <!-- \w å­—æ¯æ•°å­—_   \d æ•°å­—0-9 -->
      <van-field
        v-model="username"
        name="username"
        label="ç”¨æˆ·å"
        placeholder="ç”¨æˆ·å"
        :rules="[
          { required: true, message: 'è¯·å¡«å†™ç”¨æˆ·å' },
          { pattern: /^\w{5,}$/, message: 'ç”¨æˆ·åè‡³å°‘åŒ…å«5ä¸ªå­—ç¬¦' }
        ]"
      />
      <van-field
        v-model="password"
        type="password"
        name="password"
        label="å¯†ç "
        placeholder="å¯†ç "
        :rules="[
          { required: true, message: 'è¯·å¡«å†™å¯†ç ' },
          { pattern: /^\w{6,}$/, message: 'å¯†ç è‡³å°‘åŒ…å«6ä¸ªå­—ç¬¦' }
        ]"
      />
      <div style="margin: 16px">
        <van-button block type="info" native-type="submit">æäº¤</van-button>
      </div>
    </van-form>
  </div>
</template>

<script>
export default {
  name: 'login-page',
  data () {
    return {
      username: 'zhousg',
      password: '123456'
    }
  },
  methods: {
    onSubmit (values) {
      console.log('submit', values)
    }
  }
}
</script>
```

`login.vue`æ·»åŠ  router-link æ ‡ç­¾ï¼ˆè·³è½¬åˆ°æ³¨å†Œï¼‰

```vue
<template>
  <div class="login-page">
    <van-nav-bar title="é¢ç»ç™»å½•" />

    <van-form @submit="onSubmit"> ... </van-form>

    <router-link class="link" to="/register">æ³¨å†Œè´¦å·</router-link>
  </div>
</template>
```

`login.vue`è°ƒæ•´æ ·å¼

```jsx
<style lang="less" scoped>
.link {
  color: #069;
  font-size: 12px;
  padding-right: 20px;
  float: right;
}
</style>
```

### æ³¨å†Œé™æ€å¸ƒå±€

`register.vue`

```jsx
<template>
  <div class="login-page">
    <van-nav-bar title="é¢ç»æ³¨å†Œ" />

    <van-form @submit="onSubmit">
      <van-field
        v-model="username"
        name="username"
        label="ç”¨æˆ·å"
        placeholder="ç”¨æˆ·å"
        :rules="[{ required: true, message: 'è¯·å¡«å†™ç”¨æˆ·å' }]"
      />
      <van-field
        v-model="password"
        type="password"
        name="password"
        label="å¯†ç "
        placeholder="å¯†ç "
        :rules="[{ required: true, message: 'è¯·å¡«å†™å¯†ç ' }]"
      />
      <div style="margin: 16px">
        <van-button block type="primary" native-type="submit"
          >æ³¨å†Œ</van-button
        >
      </div>
    </van-form>
    <router-link class="link" to="/login">æœ‰è´¦å·ï¼Œå»ç™»å½•</router-link>
  </div>
</template>

<script>
export default {
  name: 'register-page',
  data () {
    return {
      username: '',
      password: ''
    }
  },
  methods: {
    onSubmit (values) {
      console.log('submit', values)
    }
  }
}
</script>

<style lang="less" scoped>
.link {
  color: #069;
  font-size: 12px;
  padding-right: 20px;
  float: right;
}
</style>
```

### request æ¨¡å— - axios å°è£…

æ¥å£æ–‡æ¡£åœ°å€ï¼šhttps://www.apifox.cn/apidoc/project-934563/api-19465917

æˆ‘ä»¬ä¼šä½¿ç”¨ axios æ¥è¯·æ±‚åç«¯æ¥å£, ä¸€èˆ¬éƒ½ä¼šå¯¹ axios è¿›è¡Œä¸€äº›é…ç½® (æ¯”å¦‚: é…ç½®åŸºç¡€åœ°å€ç­‰)

ä¸€èˆ¬é¡¹ç›®å¼€å‘ä¸­, éƒ½ä¼šå¯¹ axios è¿›è¡ŒåŸºæœ¬çš„äºŒæ¬¡å°è£…, å•ç‹¬å°è£…åˆ°ä¸€ä¸ªæ¨¡å—ä¸­, ä¾¿äºä½¿ç”¨

1. å®‰è£… axios

```
npm i axios
```

2. æ–°å»º `utils/request.js` å°è£… axios æ¨¡å—

   åˆ©ç”¨ axios.create åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ axios æ¥ä½¿ç”¨

   http://www.axios-js.com/zh-cn/docs/#axios-create-config

```js
/* å°è£…axiosç”¨äºå‘é€è¯·æ±‚ */
import axios from "axios";

// åˆ›å»ºä¸€ä¸ªæ–°çš„axioså®ä¾‹
const request = axios.create({
  baseURL: "http://interview-api-t.itheima.net/",
  timeout: 5000,
});

// æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨
request.interceptors.request.use(
  function (config) {
    // åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ
    return config;
  },
  function (error) {
    // å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ
    return Promise.reject(error);
  }
);

// æ·»åŠ å“åº”æ‹¦æˆªå™¨
request.interceptors.response.use(
  function (response) {
    // å¯¹å“åº”æ•°æ®åšç‚¹ä»€ä¹ˆ
    return response.data;
  },
  function (error) {
    // å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ
    return Promise.reject(error);
  }
);

export default request;
```

3. æµ‹è¯• (å¯ä»¥å…ˆæ³¨å†Œåç™»å½•)

```js
<script>
import request from '@/utils/request'
export default {
  async created () {
    // const res = await request.post('/user/register', {
    //   username: 'shuaipeng',
    //   password: '123456'
    // })
    const res = await request.post('/user/login', {
      username: 'shuaipeng',
      password: '123456'
    })
    console.log(res)
  }
}
</script>
```

![image-20220614054157121](./images/image-20220614054157121.png)

### toast è½»æç¤º

å°†æ¥æ— è®ºæ³¨å†ŒæˆåŠŸï¼Œè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½æ˜¯éœ€è¦ç»™ç”¨æˆ·æç¤ºçš„

https://vant-contrib.gitee.io/vant/v2/#/zh-CN/toast

ä¸¤ç§ä½¿ç”¨æ–¹å¼

1. **æ— éœ€æ³¨å†Œ**ï¼Œå¯¼å…¥ï¼Œè°ƒç”¨

```jsx
import { Toast } from "vant";
Toast("æç¤ºå†…å®¹");
```

2. **ç»„ä»¶å†…**ï¼Œé€šè¿‡ this ç›´æ¥è°ƒç”¨ ğŸ‘

æ³¨å†Œ

```js
import { Toast } from "vant";
Vue.use(Toast);
```

â€‹

è°ƒç”¨

```js
this.$toast("æç¤ºå†…å®¹");
```

â€‹

### å°è£… api æ¥å£ - æ³¨å†ŒåŠŸèƒ½

æ–°å»º `api/user.js` æä¾›æ³¨å†Œ Api å‡½æ•°

```jsx
import request from "@/utils/request";

// æ³¨å†Œæ¥å£
export const registerAPI = (data) => {
  return request.post("/user/register", data);
};
```

`register.vue`é¡µé¢ä¸­è°ƒç”¨æµ‹è¯•

```jsx
methods: {
  async onSubmit (values) {
    // å¾€åå°å‘é€æ³¨å†Œè¯·æ±‚äº†
    await registerAPI(values)
    this.$toast.success('æ³¨å†ŒæˆåŠŸ')
    this.$router.push('/login')
  }
}
```

`request.js`å“åº”æ‹¦æˆªå™¨ï¼Œç»Ÿä¸€å¤„ç†é”™è¯¯æç¤º

```jsx
import { Toast } from 'vant'

...

// æ·»åŠ å“åº”æ‹¦æˆªå™¨
request.interceptors.response.use(function (response) {
  // å¯¹å“åº”æ•°æ®åšç‚¹ä»€ä¹ˆ
  return response.data
}, function (error) {
  if (error.response) {
    // æœ‰é”™è¯¯å“åº”, æç¤ºé”™è¯¯æç¤º
    Toast(error.response.data.message)
  }
  // å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ
  return Promise.reject(error)
})
```

### å°è£… api æ¥å£ - ç™»å½•åŠŸèƒ½

`api/user.js` æä¾›ç™»å½• Api å‡½æ•°

```jsx
// ç™»å½•æ¥å£
export const loginAPI = (data) => {
  return request.post("/h5/user/login", data);
};
```

`login.vue` ç™»å½•åŠŸèƒ½

```jsx
import { loginAPI } from '@/api/user'
import { setToken } from '@/utils/storage'

methods: {
  async onSubmit (values) {
    const { data } = await loginAPI(values)
    setToken(data.token)
    this.$toast.success('ç™»å½•æˆåŠŸ')
    this.$router.push('/')
  }
}
```

### local æ¨¡å— - æœ¬åœ°å­˜å‚¨

æ–°å»º utils/storage.js

```jsx
// ä»¥å‰ token ä»¤ç‰Œï¼Œå¦‚æœå­˜åˆ°äº†æœ¬åœ°ï¼Œæ¯ä¸€æ¬¡éƒ½å†™è¿™ä¹ˆé•¿ï¼Œå¤ªéº»çƒ¦
// localStorage.setItem(é”®ï¼Œ å€¼)
// localStorage.getItem(é”®)
// localStorage.removeItem(é”®)

const KEY = "my-token-vant-mobile";

// è·å–
export const getToken = () => {
  return localStorage.getItem(KEY);
};

// è®¾ç½®
export const setToken = (token) => {
  localStorage.setItem(KEY, token);
};

// åˆ é™¤
export const delToken = () => {
  localStorage.removeItem(KEY);
};
```

## å¯¼èˆªå®ˆå«-é¡µé¢è®¿é—®æ‹¦æˆª

è¿™ä¸ª é¢ç»ç§»åŠ¨ç«¯ é¡¹ç›®ï¼Œåªå¯¹ ç™»å½•ç”¨æˆ· å¼€æ”¾ï¼Œå¦‚æœæœªç™»å½•ï¼Œä¸€å¾‹æ‹¦æˆªåˆ°ç™»å½•

1. å¦‚æœè®¿é—®çš„æ˜¯ **é¦–é¡µ**ï¼Œ æ—  tokenï¼Œ æ‹¦èµ°

2. å¦‚æœè®¿é—®çš„æ˜¯ **åˆ—è¡¨é¡µ**ï¼Œæ—  tokenï¼Œ æ‹¦èµ°

3. å¦‚æœè®¿é—®çš„æ˜¯ **è¯¦æƒ…é¡µ**ï¼Œæ—  tokenï¼Œ æ‹¦èµ°

   ....

åˆ†æï¼šå“ªäº›é¡µé¢ï¼Œæ˜¯ä¸éœ€è¦ç™»å½•ï¼Œå°±å¯ä»¥è®¿é—®çš„ï¼ => **æ³¨å†Œ** å’Œ **ç™»å½•** ï¼ˆç™½åå• - æ¸¸å®¢å¯ä»¥éšæ„è®¿é—®çš„ï¼‰

æ ¸å¿ƒé€»è¾‘ï¼š

1. åˆ¤æ–­ç”¨æˆ·æœ‰æ²¡æœ‰ tokenï¼Œ æœ‰ tokenï¼Œ ç›´æ¥æ”¾è¡Œ ï¼ˆæœ‰èº«ä»½çš„äººï¼Œæƒ³å»å“ªå°±å»å“ª~ï¼‰
2. æ²¡æœ‰ tokenï¼ˆæ¸¸å®¢ï¼‰ï¼Œå¦‚æœæ˜¯ç™½åå•ä¸­çš„é¡µé¢ï¼Œç›´æ¥æ”¾è¡Œ
3. å¦åˆ™ï¼Œæ—  tokenï¼ˆæ¸¸å®¢ï¼‰ï¼Œä¸”åœ¨è®¿é—®éœ€è¦æƒé™è®¿é—®çš„é¡µé¢ï¼Œç›´æ¥æ‹¦æˆªåˆ°ç™»å½•

`src/router/index.js`

```jsx
// ... çœç•¥å…¶å®ƒä»£ç 

import { getToken } from "@/utils/storage";
// å…¨å±€å‰ç½®å®ˆå«ï¼š
// 1. æ‰€æœ‰çš„è·¯ç”±ä¸€æ—¦è¢«åŒ¹é…åˆ°ï¼Œåœ¨çœŸæ­£æ¸²æŸ“è§£æä¹‹å‰ï¼Œéƒ½ä¼šå…ˆç»è¿‡å…¨å±€å‰ç½®å®ˆå«
// 2. åªæœ‰å…¨å±€å‰ç½®å®ˆå«æ”¾è¡Œï¼Œæ‰èƒ½çœ‹åˆ°çœŸæ­£çš„é¡µé¢

// ä»»ä½•è·¯ç”±ï¼Œè¢«è§£æè®¿é—®å‰ï¼Œéƒ½ä¼šå…ˆæ‰§è¡Œè¿™ä¸ªå›è°ƒ
// 1. from ä½ ä»å“ªé‡Œæ¥ï¼Œ ä»å“ªæ¥çš„è·¯ç”±ä¿¡æ¯å¯¹è±¡
// 2. to   ä½ å¾€å“ªé‡Œå»ï¼Œ åˆ°å“ªå»çš„è·¯ç”±ä¿¡æ¯å¯¹è±¡
// 3. next() æ˜¯å¦æ”¾è¡Œï¼Œå¦‚æœnext()è°ƒç”¨ï¼Œå°±æ˜¯æ”¾è¡Œ => æ”¾ä½ å»æƒ³å»çš„é¡µé¢
//    next(è·¯å¾„) æ‹¦æˆªåˆ°æŸä¸ªè·¯å¾„é¡µé¢

const whiteList = ["/login", "/register"]; // ç™½åå•åˆ—è¡¨ï¼Œè®°å½•æ— éœ€æƒé™è®¿é—®çš„æ‰€æœ‰é¡µé¢

router.beforeEach((to, from, next) => {
  const token = getToken();
  // å¦‚æœæœ‰tokenï¼Œç›´æ¥æ”¾è¡Œ
  if (token) {
    next();
    return;
  }

  // æ²¡æœ‰tokençš„äºº, çœ‹çœ‹ä½ è¦å»å“ª
  // (1) è®¿é—®çš„æ˜¯æ— éœ€æˆæƒçš„é¡µé¢ï¼ˆç™½åå•ï¼‰ï¼Œä¹Ÿæ˜¯æ”¾è¡Œ
  //  å°±æ˜¯åˆ¤æ–­ï¼Œè®¿é—®çš„åœ°å€ï¼Œæ˜¯å¦åœ¨ç™½åå•æ•°ç»„ä¸­å­˜åœ¨ includes
  if (whiteList.includes(to.path)) {
    next();
  } else {
    // (2) å¦åˆ™æ‹¦æˆªåˆ°ç™»å½•
    Toast("æ²¡æœ‰ç™»å½•, è¯·å…ˆç™»å½•!");
    next("/login");
  }
});

export default router;
```
